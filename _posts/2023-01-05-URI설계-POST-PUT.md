---
title: "HTTP API 설계: POST vs PUT"
date: 2023-01-05
categories: 
  - Programming
tags:
  - web
---

김영한님의 HTTP API 설계 강의에서 객체 생성 관점에서 `POST`와 `PUT`의 차이점에 대해 처음 접하여 관련 내용을 간단하게 정리해보았다.

<br>

# POST와 PUT의 기본 개념

## POST

`POST`는 서버의 리소스 컬렉션에 새로운 객체를 생성할 때 사용된다. 주로 클라이언트는 서버의 컬렉션에 데이터를 제출하고, 서버는 새로운 객체를 생성한 후 그 객체에 대한 URI를 반환한다. 이 과정에서 생성된 객체의 URI는 서버가 결정한다.

예를 들어, 사용자를 생성하는 API를 생각해보자.

### Request

```bash
POST /users
```

Request Body에는 새로운 사용자 데이터를 포함하며, 서버는 이 데이터를 처리한 후 새로운 사용자를 생성한다. 생성된 사용자의 URI는 서버가 생성한 고유한 ID로 결정된다.

### Response

```json
{
  "id": 123,
  "name": "홍길동",
  "email": "hong@example.com"
}
```

여기서 URI는 `/users/123`과 같이 서버가 제공하게 된다. `POST` 메서드는 **컬렉션 기반**으로 동작한다. 

즉, `/users`는 사용자 객체의 **컬렉션**을 나타낸다.

## PUT

`PUT`은 클라이언트가 명시적으로 특정한 URI에 리소스를 저장할 때 사용된다. 클라이언트는 객체의 URI를 알고 있으며, 그 URI에 데이터를 저장하거나 덮어쓴다. 따라서 `PUT`은 **저장소(Store) 기반**이라고 할 수 있다.

### Request

```bash
PUT /users/123
```

클라이언트는 사용자 `123`의 URI를 알고 있으며, 이 URI에 대해 데이터를 저장하거나 수정할 수 있다. `PUT` 요청이 성공하면, 이 리소스는 지정된 URI에 존재한다. 클라이언트는 객체의 ID나 위치를 서버가 아닌 자신이 결정할 수 있다.

### Response

```json
{
  "name": "홍길동",
  "email": "hong@example.com"
}
```

만약 해당 URI에 리소스가 없다면, 서버는 해당 URI에 리소스를 새로 생성할 수 있다.

<br>

# POST vs PUT: 주요 차이점

| 항목              | POST                             | PUT                              |
| ----------------- | -------------------------------- | -------------------------------- |
| **사용 목적**     | 리소스 생성 (컬렉션 기반)        | 리소스 생성/업데이트 (저장소 기반) |
| **URI**           | 서버가 생성한 URI 반환           | 클라이언트가 지정한 URI 사용      |
| **동작 방식**     | 데이터를 서버에 제출하고 처리     | 지정된 URI에 데이터 저장         |
| **멱등성**        | 비멱등성 (여러 번 호출 시 결과가 달라질 수 있음) | 멱등성 (여러 번 호출해도 같은 결과) |
| **예시**          | `POST /users`                    | `PUT /users/123`                 |

## 멱등성(Idempotency)
- `PUT` 메서드는 **멱등성**을 가진다. 동일한 `PUT` 요청을 여러 번 보내더라도 결과는 동일하다. 즉, 같은 URI에 대해 여러 번 `PUT` 요청을 보내도 최종 결과는 한 번 실행한 것과 동일하다.
- 반면 `POST`는 **비멱등성**이다. 동일한 데이터를 여러 번 `POST`하면 매번 새로운 객체가 생성될 수 있다.

<br>

# 언제 POST와 PUT을 사용할까?

## POST

- (ex) 사용자 생성 API
- 서버가 리소스의 URI를 결정해야 하는 경우.
- 새로운 객체를 생성하는 경우 (ex. 사용자 등록).
- 요청이 비멱등성을 가져도 되는 경우.

## PUT

- (ex) 파일 업로드 API.
- 클라이언트가 리소스의 URI를 알고 있으며, 해당 위치에 데이터를 저장하거나 업데이트할 때.
- 동일한 요청을 여러 번 보내도 같은 결과가 보장되어야 할 때.
- 특정 리소스를 명확하게 식별할 수 있을 때.

<br>

# 4. 결론

`POST`와 `PUT`은 비슷해 보일 수 있지만, URI 설계와 사용 방식에서 차이가 크다. 

`POST`는 **컬렉션**에 새로운 객체를 추가하는 방식으로 사용되며, 서버가 URI를 결정한다.<br>
반면, `PUT`은 **저장소**에 특정 URI에 대해 리소스를 생성하거나 업데이트할 때 사용된다.

리소스 관리의 관점에서 `POST`는 서버가 리소스를 다루는 방식에 대한 제어권을 가지고 있지만,<br>
`PUT`은 클라이언트가 명확하게 리소스의 URI를 지정한다는 차이가 있다.